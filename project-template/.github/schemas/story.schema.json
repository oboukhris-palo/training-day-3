{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/story.schema.json",
  "title": "User Story Metadata",
  "type": "object",
  "required": [
    "id",
    "title",
    "epic",
    "type",
    "risk",
    "affected_components",
    "acceptance_criteria",
    "nfrs",
    "data_contracts",
    "feature_flag",
    "rollout_plan",
    "migration",
    "test_matrix",
    "dependencies"
  ],
  "properties": {
    "id": {"type": "string", "pattern": "^US-[0-9]{3,}$"},
    "title": {"type": "string", "minLength": 3},
    "epic": {"type": "string", "pattern": "^E[0-9]{3,}$"},
    "type": {"type": "string", "enum": ["feature", "bugfix", "chore"]},
    "risk": {"type": "string", "enum": ["low", "medium", "high"]},
    "affected_components": {"type": "array", "items": {"type": "string"}},
    "acceptance_criteria": {"type": "array", "minItems": 1, "items": {"type": "string"}},
    "nfrs": {"type": "array", "items": {"type": "string"}},
    "data_contracts": {"type": "array", "items": {"type": "string"}},
    "feature_flag": {"type": "string"},
    "rollout_plan": {"type": "string"},
    "migration": {"type": "string"},
    "test_matrix": {"type": "array", "items": {"type": "string"}},
    "dependencies": {"type": "array", "items": {"type": "string"}}
  }
}